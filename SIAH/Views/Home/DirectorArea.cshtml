@{
    Layout = "~/Views/Shared/_NewLayout.cshtml";
    ViewBag.title = "Home Director de Oficina";
    ViewBag.validacion = true;
    if (ViewBag.success == null)
    {
        ViewBag.success = false;
        ViewBag.validacion = false;

    }
}

<div class="banner-catalog">
    <div class="container">
        <div class="col-md-12">
            <h1>Director de Área</h1>
            <div class="banner-catalog__content">Realice diferentes acciones de control y genere reportes para la toma de decisiones.</div>
        </div>
    </div>
</div>
<div class="container" style="padding-top: 30px; padding-bottom: 30px;">
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-6">
                <div id="alertArea  animated zoomIn">
                    <div class="alert alert-info pq-alert  degradado animated zoomIn">
                        <i class="fa fa-arrow-right tituloPanel"></i>
                        <span class="tituloPanel">Stock</span>
                    </div>
                </div>
                <div class="col-md-6 animated zoomIn">
                    <div class="card card-project">

                        <div class="content text-center">
                            <div class="info">
                                <div class="icon icon-success">
                                    <i class="material-icons">equalizer</i>
                                </div>
                                <h4 class="info-title">
                                    <a>Control de Stock</a>
                                </h4>
                                <p>Controle la Base de Datos de SIAH y actualice el Stock de Insumos.</p>
                                <div class="btn btn-round btn-softPurple" onclick="location.href='@Url.Action("ControlStock", "Insumos")'">Ir a control de Stock</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 animated zoomIn">
                    <div class="card card-project">

                        <div class="content text-center">
                            <div class="info">
                                <div class="icon icon-info">
                                    <i class="material-icons">storage</i>
                                </div>
                                <h4 class="info-title">
                                    <a>Stock de Insumos</a>
                                </h4>
                                <p>Listado de Insumos Médicos y su Stock disponible en este momento.</p>
                                <div class="btn btn-round btn-softPurple" onclick="location.href='@Url.Action("StockInsumos", "Insumos")'">Ir a la tabla de Stock</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 animated zoomIn">
                    <div class="card card-project">

                        <div class="content text-center">
                            <div class="info">
                                <div class="icon icon-info">
                                    <i class="material-icons">work</i>
                                </div>
                                <h4 class="info-title">
                                    <a>Administrar compras</a>
                                </h4>
                                <p>Cargue remitos de compra de insumos</p>
                                <div class="btn btn-round btn-softPurple" onclick="location.href='@Url.Action("Index", "Compras")'">Ir a Compras</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div id="alertArea  animated zoomIn">
                    <div class="alert alert-info pq-alert  degradado animated zoomIn">
                        <i class="fa fa-arrow-right"></i>
                        <span class="tituloPanel">Reportes y Pedidos</span>
                    </div>
                </div>
                <div class="col-md-6 animated zoomIn">
                    <div class="card card-project">

                        <div class="content text-center">
                            <div class="info">
                                <div class="icon icon-danger">
                                    <i class="material-icons">timeline</i>
                                </div>
                                <h4 class="info-title">Reporte de Consolidado</h4>
                                <p>Visualice un reporte con la cantidad de insumos pedida por cada hospital</p>

                                <a id="reporte" class="btn btn-round btn-softPurple" @*onclick="location.href='@Url.Action("ReporteConsolidado", "DetallesPedido", new { fechaInicio = new DateTime(2017, 2, 2), fechaFin = new DateTime(2017, 11, 1) })'"*@>Generar Reporte</a>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-md-6 animated zoomIn">
                    <div class="card card-project">

                        <div class="content text-center">
                            <div class="info">
                                <div class="icon icon-success">
                                    <i class="material-icons">send</i>
                                </div>
                                <h4 class="info-title">
                                    <a>Administrar Pedidos</a>
                                </h4>
                                <p>Controle y Autorice Pedidos de Insumos</p>
                                <div class="btn btn-round btn-softPurple" onclick="location.href='@Url.Action("Listado", "Pedidos")'">Ir a Pedidos</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
</div>

@section Scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            if (@ViewBag.success.ToString().ToLower() ===true) {
                    $.notify({
                        title: '<strong>Aviso!</strong><br/>',
                        message: 'La actualizacion de stock fue realizada exitosamente.'
                    }, {
                            type: 'success',
                            offset: {
                                x: 20,
                                y: 90
                            }
                        },
                    );

                }
                else {
                if (@ViewBag.validacion.ToString().ToLower()===true) {
                    $.notify({
                        title: '<strong>Aviso!</strong><br/>',
                        message: 'Hubo un error en la actualizacion: @ViewBag.problem '
                    }, {
                            type: 'danger',
                            offset: {
                                x: 20,
                                y: 80
                            }
                        },
                    );
                }

            }
            var myNewURL = refineURL();
            //here you pass the new URL extension you want to appear after the domains '/'. Note that the previous identifiers or "query string" will be replaced.
            window.history.pushState("object or string", "Title", "/" + myNewURL);
            //Helper function to extract the URL between the last '/' and before '?'
            //If URL is www.example.com/one/two/file.php?user=55 this function will return 'file.php'
            //pseudo code: edit to match your URL settings
            function refineURL() {
                //get full URL
                var currURL = window.location.href; //get current address

                //Get the URL between what's after '/' and befor '?'
                //1- get URL after'/'
                var afterDomain = currURL.substring(currURL.lastIndexOf('/') + 1);
                //2- get the part before '?'
                var beforeQueryString = afterDomain.split("?")[0];

                return "Home/" + beforeQueryString;
            }
        });

        $(document).on('click', '#reporte', function (event)
        {
            event.preventDefault();
            var url = '@Url.Action("ReporteConsolidado", "DetallesPedido", new { fechaInicio = "START" , fechaFin = "END" })';

            var nd = new Date();
            nd.setDate(nd.getDate() - 30); // minus the date
            var month = nd.getUTCMonth() + 1; //months from 1-12
            var day = nd.getUTCDate();
            var year = nd.getUTCFullYear();
            start = year + "-" + month + "-" + day;

            var dateObj = new Date();
            var month = dateObj.getUTCMonth() + 1; //months from 1-12
            var day = dateObj.getUTCDate();
            var year = dateObj.getUTCFullYear();
            end = year + "-" + month + "-" + day;

            url = url.replace("START", start);
            url = url.replace("END", end);
            url = url.replace("amp;", "");
            location.href = url;
            });
    </script>
}
